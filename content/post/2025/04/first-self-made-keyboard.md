+++
title = "基板設計から自分でkeyboardを作ってみた"
author = ["derui"]
date = 2025-04-12T21:37:00+09:00
tags = ["キーボード"]
draft = false
+++

気づいたら新入社員が入って来てました。3月はどこに行った？ :thinking:

3月はずっとタイトルにあるものを作っていました。やっと形になったので、記事にしてみます。

<!--more-->


## とりあえずの完成形 {#とりあえずの完成形}

こんなんなりました。（カバープレートがホントはあるんですが、発注したデータに含めるのを忘れました :cry:）

{{< figure src="/ox-hugo/2025-04_keyboard_1.png" >}}

基本的な構成としては

-   40%の分割式キーボード
-   カラムスタッガード
-   [BLE Micro Pro](https://shop.yushakobo.jp/products/ble-micro-pro?srsltid=AfmBOoreQUN12bBlvrYy7fJc64xr3gnX_y-W6EH4uYyrAPJR-16psVBo)での無線接続
    -   電池は **単4電池**
-   16.5mmの挟ピッチ with ロープロファイル
    -   choc v2です

となっております。BLE Micro Proを利用しているので、[vial](https://get.vial.today/)にも対応済みとなっています。なおキースイッチは[Kailh Choc v2 Deep Sea Silent Islet](https://keeb-on.com/products/kailh-choc-v2-deep-sea-silent)を選択してます。マジで静音ですが、[こっち](https://keeb-on.com/products/kailh-choc-v2-white-rain?pr_prod_strat=e5_desc&pr_rec_id=c4d1cf3e3&pr_rec_pid=7179211309150&pr_ref_pid=7179211505758&pr_seq=uniform)と比較すると、若干打鍵感がグニュッとしてます。好みの範囲ではあると思いますが。

リポジトリはこちら。firmwareもおいてあります。
<https://github.com/derui/wikbd>


## 作成の動機 {#作成の動機}

動機としては、 **新しいことをやってみよう** ってのが一番大きいです。なんでキーボードなの？についてはまぁまぁということで。

ただ、作成にあたっては一回も使ったことがないもので、基本的に自分がほしいものを詰めました。

-   なんだかんだ分割式の無線って使ったことがない
-   大抵ボタン電池だけど、部屋にエネループの充電器もあるし、充電池で使えそう
-   挟ピッチってほぼ使ったことがない

よりデザイン性や機能性に優れたものは世にありますが、探した限りでは上記を満たすものはなかったです。ならばちょうどいいし作るか、と。


## 設計にあたっての情報源 {#設計にあたっての情報源}

今から自分で始めようと思っている方は、まずこれを購入して熟読するのをおすすめします。

[自作キーボード設計ガイド Vol1 設計入門編](https://keeb-on.com/products/keyboard-design-guide-vol1)
[自作キーボード設計ガイド Vol2 ケース設計編](https://keeb-on.com/products/keyboard-design-guide-vol2)

ケース設計編は、初めて作るのならなくても・・・って思われるでしょうが、ちょっと凝りだすとすぐに必要になる情報ばかりなので、昼食を一週間安くして購入しときましょう。

```text
私も最初は単なるプレートサンドイッチにしようかと思いましたが、読んでるうちに積層ケースに惹かれてそっちにしました。
```

上記の資料には、Guide68というリポジトリで案内されてますが、自分の作りたいものが全然毛色が違うものだったので、ゼロから作ることになりました。


## 基板の設計 {#基板の設計}

今回、大抵のBLE Micro Proベースの自作キーボードにはない **単4電池** での起動、というのがあったので、そこが一番の課題となりました。

BLE Micro Proでは3.3Vの電源が必要なのですが、単4電池では1.5Vしかできません。ボタン電池を利用する作例では、直列に設定して電圧を確保しているのがほとんどですが、単4電池を2本乗せるというのは、実装上しんどいです。となると、単4電池一本で動作させるために **昇圧回路** が必要になります。この昇圧回路は、基本的に利用するものがケースバイケースになるため、自分でfootprintを用意する必要があったりしました。

ほとんど電子回路的な知識がない中で、いきなりデータシートをみながらfootprintを作るのは中々怖い（実際に組み立てないとわかんない）ため、公開されているfootprintを利用するのをおすすめします。


### 今回利用した昇圧回路 {#今回利用した昇圧回路}

色々調べましたが、今回は[秋月電子が出している](https://akizukidenshi.com/catalog/g/g113066/)昇圧回路を利用しました。選択のポイントとしては、

-   コンデンサなどがすでに実装されていて、余計なものが不要
-   ON/OFFを切り替えできる
-   入力電圧が単4電池で利用でき、出力が3.3V

という条件を満たしていることから選定しました。


### 挟ピッチ固有の課題 {#挟ピッチ固有の課題}

今回、キーピッチは **16.5mm** というものを選択しました。が！これは非常に課題が大きいです。

<https://e3w2q.github.io/10/>

2020年の記事ですが、2025でも状況はほぼかわっていないため、参照させていただきます。

そもそもですが、 **対応しているキーキャップ自体が極端に少ない** というのがあります。特に16.5mmとなるとほぼ3Dプリンター製以外でほぼ絶無と言っても過言ではありません。

3Dプリンター製のものは、色々あるため基本的にはコストが高いです。また、3Dプリンター製のものは誤差の問題もあります。

そういった事情と入手性を加味したところ、 **KeychronのJP配列** が16.5mmであることを知りました。到着まで若干時間はかかりますが、現状ほぼ唯一の大量生産されている16.5mmキーキャップではないでしょうか。

<https://keychron.co.jp/products/keychron-jis-low-profile-abs-full-set-keycap>

Keychronのキーボード自体に食指が動いたことがない（もはや外付けのキーボードでrow staggeredを利用するという気持ちにならないため）のですが、このキーキャップは本当に希少です。現時点では、US配列向けについてはピッチが異なるようで、挟ピッチ向けとしては利用することができないと思われます。

また、キーキャップ以外でも、基板設計時の課題として **ソケットやダイオードの配置自由度が低い** というものがあります。一般的な19.05mmと比較して16.5では2.55mm小さいため、全域にわたって難易度が上がります :cry:
（最初に設計するので挟ピッチはおすすめしません。はんだ付けの難易度も上がります）


## PCBとケースの発注 {#pcbとケースの発注}

今回は[JLCPCB](https://jlcpcb.com/)に基板を発注し、ミドル・ボトム・カバープレートはアクリル素材ということで[anymany](https://anymany.net/)に発注しました。大体お値段としては、PCBは$61、アクリルは5000円くらいです（アクリルは追加発注があったのでもう4000円くらいかかってますが・・・）。

実際自分で発注してみると、 **なぜ自作キーボードの基板とかが高く感じるのか** がよくわかります。スケールメリットが効かないものは割高になる、という資本主義（？）がよくわかります。自分で使うものとなると、費用に糸目をつけない感じにはなってますが、単純にかかっている金額だけを考えると、市販の高級キーボードを軽く超えます。


## 実際組み立ててみて {#実際組み立ててみて}

やっぱり、自分で設計した基板の実物が届く、というのはテンションがあがります。今回私も初めて知りましたが、基板はこんな感じで届きます。

{{< figure src="/ox-hugo/2025-04_keyboard_2.png" >}}

JCLPCBでは最小単位が5枚なので、5枚がこんな感じで圧着された感じで届きます。これ、スイッチプレートのような隙間が多いプレートだと、この圧着されたものが隙間でくっついて、大変に剥がしづらいです。変にスイッチプレートに細い部分を利用したりすると、恐々として剥がす羽目になります（やった）。


### 昇圧回路が細かい {#昇圧回路が細かい}

今回自分で設計するなかで、一番難関と写ったのは、昇圧回路のはんだ付けでした。

```text
JCLPCBに発注するとき、特定の部材については機械での実装ができるようです。が、個人的にははんだづけが嫌いではないので、基本自分でやっています
```

実際こんな感じです。

{{< figure src="/ox-hugo/2025-04_keyboard_3.png" >}}

上にあるPro Microの幅と比べてもらえればわかるかと。Pro Microをはんだ付けできる人であれば問題ないとは思いますが。


## 設計での反省事項 {#設計での反省事項}

初めて設計して組み立てて、一応完動すること自体は確認がとれてますが、色々反省事項はあります。

-   BLE Micro Proの向き
    -   本当は裏向きにしようと思ってましたが、そのまんまになってました。
-   電源スイッチの向きが各々違う
    -   それぞれ逆になることが完全に抜けていたので、各々で逆になっちゃいました 😵
-   ミドルプレートのサイズが右手と左手で違う
    -   一致させようとしたら、回線の関係で一致できませんでした
-   キーピッチがギリギリを攻めすぎた
    -   前述のキーキャップが16.5mmということで16.5mmぴったりにしましたが、製造誤差とかで微妙に差異があると引っかかります

次回があればもっと考えてみたいと思います。一番の課題は **かな入力の実装難易度が高すぎる** ことではあります。


## いい経験です {#いい経験です}

今回、初めて自分で基板を設計して組み立ててみましたが、色々いい経験になりました。今まではんだ付けしてキットを組み立てた事自体はありましたが、既存のキットが色々考えられていることがよくわかりました。

最近のキットは、煩雑なはんだ付けなどをせずに組み立てることができるのが多いですし、実際利用する側としてはそれがありがたいこともあります。が、ゼロベースで設計することで、 **どういうものが** 欲しくて、 **なぜ必要なのか** を思考するようになります。結局理想は各々の中にしかありませんし、妥協するかどうか、というところもあるでしょう。

個人的には、今までにキットを作ったことがあることで、はんだ付けの順序や方法などは、経験をそのまま流用できたので、一回ははんだ付けしてみることをおすすめします。今回みたいな、ふつう使わないような部品を利用すると、そこは自分でなんとかする必要があるので。

まだ完成はしていない（カバープレートがまだきていない）のですが、仕事でも利用していってみようと思います。
